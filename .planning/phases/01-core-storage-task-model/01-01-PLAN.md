---
phase: 01-core-storage-task-model
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - task.py
  - week_utils.py
  - storage.py
autonomous: true

must_haves:
  truths:
    - "Tasks can be created with auto-generated IDs"
    - "Tasks are assigned to correct week using Monday-Sunday boundaries"
    - "Tasks persist to JSON file without data loss"
    - "File read errors produce clear error messages"
    - "File write errors produce clear error messages"
  artifacts:
    - path: "task.py"
      provides: "Task model with ID generation"
      min_lines: 20
      contains: "class Task"
    - path: "week_utils.py"
      provides: "Week boundary calculation (Monday-Sunday)"
      min_lines: 15
      contains: "def get_week_start"
    - path: "storage.py"
      provides: "JSON persistence with error handling"
      min_lines: 40
      contains: "class TaskStore"
  key_links:
    - from: "task.py"
      to: "week_utils"
      via: "import for week assignment"
      pattern: "from week_utils import|import week_utils"
    - from: "storage.py"
      to: "task.py"
      via: "import for Task serialization"
      pattern: "from task import|import task"
    - from: "storage.py"
      to: "tasks.json"
      via: "try/except wrapped file operations"
      pattern: "try:.*json\\.(load|dump).*except"
---

<objective>
Create the foundational storage layer with task model, week utilities, and JSON persistence with proper error handling.

Purpose: Establish the core data structures and storage mechanisms that Phase 2 CLI will build upon. This phase ensures tasks can be reliably persisted with week-based organization and robust error handling.

Output: Three Python modules (task.py, week_utils.py, storage.py) providing task modeling, week calculation, and JSON storage capabilities.
</objective>

<execution_context>
@C:\Users\vdala\.claude\get-shit-done\workflows\execute-plan.md
@C:\Users\vdala\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@C:\Users\vdala\OneDrive\gsd\.planning\PROJECT.md
@C:\Users\vdala\OneDrive\gsd\.planning\ROADMAP.md
@C:\Users\vdala\OneDrive\gsd\.planning\REQUIREMENTS.md
@C:\Users\vdala\OneDrive\gsd\.planning\STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Task Model Module</name>
  <files>task.py</files>
  <action>
Create task.py in the project root with:

1. Task class with attributes:
   - id (string, auto-generated UUID)
   - text (string, task description)
   - completed (boolean, default False)
   - week_start (string, ISO date format for Monday of the week)
   - created_at (string, ISO datetime)

2. Use uuid.uuid4() for ID generation (not sequential numbers - UUIDs are more robust)

3. Add to_dict() method for JSON serialization

4. Add from_dict(data) classmethod for JSON deserialization

5. Import week_utils to calculate week_start automatically on task creation (use get_week_start function)

Use Python standard library only: uuid, datetime, json. No external dependencies.
  </action>
  <verify>
Run: python -c "from task import Task; t = Task('test task'); print(f'ID: {t.id}, Week: {t.week_start}')"

Should print task with UUID and week_start date.
  </verify>
  <done>
task.py exists with Task class that auto-generates UUIDs, calculates week_start, and provides serialization methods.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Week Utilities Module</name>
  <files>week_utils.py</files>
  <action>
Create week_utils.py in the project root with:

1. get_week_start(date=None) function:
   - Takes optional datetime.date parameter (defaults to today)
   - Returns Monday of the week as ISO date string (YYYY-MM-DD)
   - Week starts Monday (weekday() == 0), ends Sunday
   - Calculate: date - timedelta(days=date.weekday())

2. get_week_end(date=None) function:
   - Returns Sunday of the week as ISO date string
   - Calculate: week_start + timedelta(days=6)

3. Add docstrings explaining Monday-Sunday week boundaries

Use Python standard library only: datetime. No external dependencies.
  </action>
  <verify>
Run: python -c "from week_utils import get_week_start, get_week_end; import datetime; monday = datetime.date(2026, 1, 27); print(f'Start: {get_week_start(monday)}, End: {get_week_end(monday)}')"

Should print Start: 2026-01-27, End: 2026-02-02 (Monday to Sunday).
  </verify>
  <done>
week_utils.py exists with get_week_start and get_week_end functions that correctly calculate Monday-Sunday week boundaries.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create Task Storage Module</name>
  <files>storage.py</files>
  <action>
Create storage.py in the project root with:

1. TaskStore class with:
   - __init__(self, filepath='tasks.json'): Store filepath
   - load_tasks(self): Read tasks from JSON, return list of Task objects
   - save_tasks(self, tasks): Write list of Task objects to JSON
   - add_task(self, task): Add task to storage and save
   - get_tasks_for_week(self, week_start): Return tasks for specific week

2. Error handling (requirement ERR-02):
   - Wrap json.load in try/except: catch FileNotFoundError (return empty list), JSONDecodeError (print clear error: "Error: tasks.json is corrupted")
   - Wrap json.dump in try/except: catch IOError (print clear error: "Error: Cannot write to tasks.json - check permissions")

3. JSON structure: {"tasks": [{"id": "...", "text": "...", "completed": false, "week_start": "...", "created_at": "..."}]}

4. Import Task class for serialization/deserialization

Use Python standard library only: json, os. No external dependencies.
  </action>
  <verify>
Run test script:
```python
from storage import TaskStore
from task import Task

store = TaskStore('test_tasks.json')
task = Task('Test task')
store.add_task(task)
loaded = store.load_tasks()
print(f'Saved and loaded: {loaded[0].text}')

# Test error handling
import os
os.remove('test_tasks.json')
empty = store.load_tasks()
print(f'Empty load works: {len(empty) == 0}')
```

Should print successful save/load and empty load without crashes.
  </verify>
  <done>
storage.py exists with TaskStore class providing add, load, save operations with proper error handling for file read/write failures.
  </done>
</task>

</tasks>

<verification>
All three modules exist and can be imported without errors:
- python -c "from task import Task"
- python -c "from week_utils import get_week_start"
- python -c "from storage import TaskStore"

Week calculation is correct (Monday start, Sunday end).
Task creation auto-generates UUIDs and week_start.
Storage operations handle file errors gracefully.
</verification>

<success_criteria>
1. task.py contains Task class with UUID generation and week assignment
2. week_utils.py correctly calculates Monday-Sunday week boundaries
3. storage.py provides JSON persistence with try/except error handling
4. All modules use Python standard library only (no external dependencies)
5. File read errors return empty list or print clear message (no crashes)
6. File write errors print clear message (no silent failures)
</success_criteria>

<output>
After completion, create C:\Users\vdala\OneDrive\gsd\.planning\phases\01-core-storage-task-model\01-01-SUMMARY.md
</output>
